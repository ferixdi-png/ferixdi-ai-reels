<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Оплата — ferixdi.ai</title>
  <style>
    :root{
      --bg:#06070b; --card:rgba(255,255,255,.06); --text:#e9eefc; --muted:rgba(233,238,252,.72);
      --line:rgba(255,255,255,.10); --a:#7cf7ff; --b:#b06cff; --c:#ff5fd7; --r:22px;
      --shadow: 0 24px 70px rgba(0,0,0,.55);
    }
    *{box-sizing:border-box}
    body{
      margin:0; color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(124,247,255,.18), transparent 55%),
        radial-gradient(1200px 800px at 85% 15%, rgba(176,108,255,.22), transparent 55%),
        radial-gradient(1200px 800px at 70% 80%, rgba(255,95,215,.12), transparent 55%),
        var(--bg);
    }
    .wrap{max-width:980px; margin:0 auto; padding:22px 16px 60px}
    .card{
      border:1px solid var(--line); border-radius:var(--r);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));
      box-shadow: var(--shadow);
      padding:16px;
    }
    .h1{margin:0 0 6px; font-size:30px; letter-spacing:-.4px}
    .sub{margin:0 0 14px; color:var(--muted); line-height:1.5}
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      padding:12px 14px; border-radius:999px; text-decoration:none; font-weight:800;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
    }
    .btn.primary{
      border:none; color:#081018;
      background:linear-gradient(135deg,var(--a),var(--b),var(--c));
    }
    .grid{display:grid; gap:12px; grid-template-columns: 1fr 1fr}
    @media (max-width: 840px){ .grid{grid-template-columns:1fr} }
    .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-size:12px; padding:2px 6px; border:1px solid var(--line); border-radius:8px; background:rgba(255,255,255,.04)}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .fine{font-size:12px; color:rgba(233,238,252,.62); line-height:1.55}
    .big{font-size:34px; font-weight:950; letter-spacing:-.4px}
    .line{height:1px; background:var(--line); margin:14px 0}
  
    .check{display:flex; gap:10px; align-items:center; user-select:none; margin-top:6px; color:var(--muted); font-weight:650;}
    .check input{width:18px; height:18px;}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="h1">Оплата по СБП (ЮMoney)</div>
      <div class="sub">Переводи сумму за выбранную услугу, сохраняй чек и отправляй его в Telegram — после чека я выдаю доступ/приступаю к ролику.</div>

      <div class="grid">
        <div class="card" style="padding:14px;">
          <div class="fine">Вы выбрали</div>
          <div id="planTitle" style="font-weight:950; font-size:18px;">—</div>
          <div class="big" id="planPrice">—</div>
          <div class="fine" id="planDesc">—</div>
          <div class="line"></div>
          <div class="row">
            <a class="btn" href="https://ferixdi-png.github.io/ferixdi-ai-reels/" rel="noopener">← Вернуться на сайт</a>
            <a class="btn" href="https://t.me/ferixdiii" target="_blank" rel="noopener">Отправить чек в TG</a>
          </div>
          <div class="line"></div>
          <label class="check">
            <input type="checkbox" id="paidCheck" />
            <span>Оплата выполнена — отправить ТЗ</span>
          </label>
          <button class="btn primary" id="sendBtn" style="width:100%; margin-top:10px;" disabled>Я оплатил(а) → отправить ТЗ</button>
          <div class="fine" id="status" style="margin-top:10px;">ТЗ отправится мне только после подтверждения оплаты. Чек пришли в TG — так я сразу стартую.</div>
        </div>

        <div class="card" style="padding:14px;">
          <div style="font-weight:950; margin-bottom:8px;">Реквизиты</div>
          <div class="sub" style="margin-bottom:10px;">
            Номер: <span class="kbd">89962176524</span><br/>
            Банк: <span class="kbd">ЮMoney</span><br/>
            Получатель: <span class="kbd">Дмитрий</span>
          </div>
          <div class="fine">
            После перевода отправь в Telegram: чек + что за услуга + свой @username, чтобы я быстро нашёл заявку.
          </div>
          <div class="line"></div>
          <div class="row">
            <a class="btn" href="https://t.me/ferixdiii" target="_blank" rel="noopener">TG: @ferixdiii</a>
            <a class="btn" href="https://telegra.ph/Besplatnyj-mini-kurs-Svoj-Telegram-bot-s-50-nejrosetyami-fotovideo-v-rublyah-bez-VPN-i-dollarov-01-16?utm_source=ig&utm_medium=social&utm_content=link_in_bio&fbclid=PAZXh0bgNhZW0CMTEAc3J0YwZhcHBfaWQMMjU2MjgxMDQwNTU4AAGnwYmVtH4Es7cxeoxnptQWRQx45IN-6jUDjtN1BB2yrxQFZ3OUV1qdVXumwZ8_aem_u61jYloSq6mTJrGUKXMSsA" target="_blank" rel="noopener">Разбор “бот под ключ”</a>
          </div>
        </div>
      </div>

      <div class="fine" style="margin-top:12px;">
        Подсказка: если ты оплатил и отправил чек — я считаю заявку принятой и беру в работу по очереди, без лишних созвонов.
      </div>
    </div>
  </div>

  <script>
    const FORMSPREE_ENDPOINT = "https://formspree.io/f/mkozydla";
    const LS_KEY = "ferixdi_lead_v1";

    const plans = {
      reel_1:{title:"AI Reels · 1 ролик", price:"2 000 ₽", desc:"Срок до 24 часов · 1–2 правки · 9:16"},
      reel_5:{title:"AI Reels · пакет 5", price:"9 000 ₽", desc:"Серия роликов под один продукт · варианты хука · план публикаций"},
      reel_20:{title:"AI Reels · месяц 20", price:"40 000 ₽", desc:"Единая стратегия · контент‑план · приоритет в очереди"},
      edu_basic:{title:"Обучение · записи уроков", price:"3 000 ₽", desc:"База по промптам/персонажу/стилю + структура подачи"},
      access_500:{title:"Доступ к платформе · практика", price:"500 ₽", desc:"Месяц практики + быстрый гайд и подсказки"}
    };

    const url = new URL(window.location.href);
    const plan = url.searchParams.get("plan") || "reel_1";
    const p = plans[plan] || plans.reel_1;

    document.getElementById("planTitle").textContent = p.title;
    document.getElementById("planPrice").textContent = p.price;
    document.getElementById("planDesc").textContent = p.desc;

    const savedRaw = localStorage.getItem(LS_KEY);
    let saved = null;
    try{ saved = savedRaw ? JSON.parse(savedRaw) : null; }catch(e){ saved=null; }

    // Если человек попал сюда без шага 1 — вернём на форму
    if(!saved || !saved.name || !saved.telegram){
      document.getElementById("status").textContent = "Сначала заполни ТЗ на сайте, затем вернись сюда для оплаты.";
    }

    const paidCheck = document.getElementById("paidCheck");
    const sendBtn = document.getElementById("sendBtn");
    paidCheck.addEventListener("change", ()=>{ sendBtn.disabled = !paidCheck.checked; });

    function toFormBody(obj){
      const params = new URLSearchParams();
      Object.entries(obj).forEach(([k,v])=>params.append(k, String(v ?? "")));
      return params;
    }

    sendBtn.addEventListener("click", async ()=>{
      if(!saved){ return; }
      sendBtn.disabled = true;
      document.getElementById("status").textContent = "Отправляю ТЗ…";
      const payload = {
        plan: saved.plan || plan,
        name: saved.name,
        telegram: saved.telegram,
        link: saved.link || "",
        task: saved.task || "",
        paid_confirmed: "yes",
        paid_confirmed_at: new Date().toISOString(),
        page_plan: plan,
        _subject: "Оплата подтверждена · " + (saved.plan || plan)
      };

      try{
        const res = await fetch(FORMSPREE_ENDPOINT, {
          method:"POST",
          headers:{ "Accept":"application/json", "Content-Type":"application/x-www-form-urlencoded" },
          body: toFormBody(payload)
        });

        if(res.ok){
          localStorage.removeItem(LS_KEY);
          window.location.href = "thanks.html?plan=" + encodeURIComponent(saved.plan || plan);
          return;
        }
        document.getElementById("status").textContent = "Похоже, ТЗ не ушло. Нажми ещё раз или просто пришли чек и ТЗ в TG.";
        sendBtn.disabled = false;
      }catch(e){
        document.getElementById("status").textContent = "Сеть глючит. Пришли чек и ТЗ в TG — я подхвачу вручную.";
        sendBtn.disabled = false;
      }
    });
  </script>
</body>
</html>
